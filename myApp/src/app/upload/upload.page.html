<ion-header>
    <ion-toolbar class="new-background-color">
        <ion-title style="color: white;">Upload</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content padding>

    <app-loading *ngIf="busy"></app-loading>

    <div class="center" *ngIf="!busy">
        <div class="camera">

        </div>

        <!-- <input type="file" *ngIf="!imageURL" (change)="fileChanged($event)" class="filebtn" #fileButton>
  <ion-button shape="round" color="primary" (click)="uploadFile()" *ngIf="!imageURL" fill="outline">UPLOAD FILE</ion-button> -->
        <input type="file" *ngIf="!imageURL" (change)="fileChanged($event)" class="filebtn" #fileButton />

        <ion-button shape="round" color="primary" (click)="uploadFileOld()" *ngIf="!imageURL" fill="outline">Upload File
        </ion-button>

        <div *ngIf="imageURL">

            <ion-grid>
                <ion-row>
                    <ion-col size="12">
                        <ion-img src="https://ucarecdn.com/{{ imageURL }}/-/preview/{{ activeEffect }}"></ion-img>
                        <ion-card-content>
                            <ion-textarea placeholder="Enter some description" [(ngModel)]="desc"></ion-textarea>
                            <ion-button shape="round" color="primary" (click)="createPost()">POST</ion-button>
                        </ion-card-content>
                    </ion-col>
                </ion-row>

                <ion-row>
                    <ion-col [class.active]="activeEffect==effects.effect1" (click)="setSelected('effect1')">
                        <ion-img src="http://ucarecdn.com/{{ imageURL }}/{{ scaleCrop }}/"></ion-img>
                    </ion-col>
                    <ion-col [class.active]="activeEffect==effects.effect2" (click)="setSelected('effect2')">
                        <ion-img src="http://ucarecdn.com/{{ imageURL }}/{{ scaleCrop }}/{{ effects.effect2 }}"></ion-img>
                    </ion-col>
                    <ion-col [class.active]="activeEffect==effects.effect3" (click)="setSelected('effect3')">
                        <ion-img src="http://ucarecdn.com/{{ imageURL }}/{{ scaleCrop }}/{{ effects.effect3 }}"></ion-img>
                    </ion-col>
                    <ion-col [class.active]="activeEffect==effects.effect4" (click)="setSelected('effect4')">
                        <ion-img src="http://ucarecdn.com/{{ imageURL }}/{{ scaleCrop }}/{{ effects.effect4 }}"></ion-img>
                    </ion-col>
                    <ion-col [class.active]="activeEffect==effects.effect5" (click)="setSelected('effect5')">
                        <ion-img src="http://ucarecdn.com/{{ imageURL }}/{{ scaleCrop }}/{{ effects.effect5 }}"></ion-img>
                    </ion-col>
                </ion-row>

                <ion-row *ngIf="noFace">
                    <ion-col size="12">
                        <p class="no-face">
                            Image with faces perform 150 times better!
                        </p>
                    </ion-col>
                </ion-row>
            </ion-grid>

        </div>
    </div>



    <!-- Newwwwww -->
    <ion-progress-bar [value]="uploadProgress" color="success"></ion-progress-bar>
    <ion-list>
        <ion-item-sliding *ngFor="let f of files">
          <ion-item (click)="openFile(f)">
            <ion-icon name="image" slot="start" *ngIf="f.name.endsWith('jpg')"></ion-icon>
            <ion-icon name="videocam" slot="start" *ngIf="f.name.endsWith('MOV') || f.name.endsWith('mp4')"></ion-icon>
            <ion-icon name="mic" slot="start" *ngIf="f.name.endsWith('wav')"></ion-icon>
     
            <ion-label class="ion-text-wrap">
              {{ f.name }}
              <p>{{ f.fullPath }}</p>
            </ion-label>
          </ion-item>
     
          <!-- <ion-item-options side="start">
            <ion-item-option (click)="deleteFile(f)" color="danger">
              <ion-icon name="trash" slot="icon-only"></ion-icon>
            </ion-item-option>
          </ion-item-options> -->

          <ion-item-options side="start">
            <ion-item-option (click)="deleteFile(f)" color="danger">
              <ion-icon name="trash" slot="icon-only"></ion-icon>
            </ion-item-option>
          </ion-item-options>
     
     
          <ion-item-options side="end">
            <ion-item-option (click)="uploadFile(f)" color="primary">
              <ion-icon name="cloud-upload" slot="icon-only"></ion-icon>
            </ion-item-option>
          </ion-item-options>
     
        </ion-item-sliding>
      </ion-list>

      <input type="file" name="file" id="file" (change)="uploadImage($event)">
      <ion-progress-bar type="indeterminate" value="{{ uploadPercent | async }}"></ion-progress-bar>
      <div [hidden]="!image">
        <img [src]="image || '//:0' ">
      </div>
      <ion-item>
        <ion-input clearInput type="text" placeholder="Post Title" [(ngModel)]="title" ngModel required></ion-input>
    </ion-item>
    <ion-item>
        <ion-input clearInput type="text" placeholder="Post Content" [(ngModel)]="content" rows="10" ngModel required></ion-input>
    </ion-item>
    <ion-button color="primary" (click)="createPost()" [disabled]="!title || !content || !image">{{saving}}</ion-button>

</ion-content>
<!-- <ion-footer>
    <ion-toolbar color="primary">
      <ion-button fill="clear" expand="full" color="light" (click)="selectMedia()">
        <ion-icon slot="start" name="document"></ion-icon>
        Select Media
      </ion-button>
    </ion-toolbar>
  </ion-footer> -->