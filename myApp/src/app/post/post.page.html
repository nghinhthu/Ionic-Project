<ion-header>
    <ion-toolbar class="new-background-color">
        <ion-buttons slot="start">
            <ion-button (click)="back()" *ngIf="!isModal">
                <ion-icon src="/assets/icons/chevron-back-outline.svg"></ion-icon>
            </ion-button>
        </ion-buttons>
        <ion-title style="color: white; ; text-align: center;">
            Post
        </ion-title>
        <ion-buttons slot="end">
            <ion-button *ngIf="!isModal">
                <ion-icon></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content fullscreen>

    <app-loading *ngIf="!post"></app-loading>
    <ion-card *ngIf="post as posts" class="card-1">
        <ion-item>
            <ion-avatar slot="start">
                <img src="http://ucarecdn.com/{{profilePic}}/-/preview/">
            </ion-avatar>
            <ion-label>
                <h3 (click)="goToUser(post.userID)">{{post.author}}</h3>
                <p>{{ post.published.toDate() | date: 'dd MMM, yyyy ' }}</p>
            </ion-label>
            <ion-icon *ngIf="post.userID == userID" src="/assets/icons/ellipsis-vertical-outline.svg"
                (click)="options()" slot="end"></ion-icon>
        </ion-item>

        <ion-img *ngIf="post.typeFile == 'image'" (dblclick)="toggleHeart()" src="{{post.image}}"></ion-img>
        <video *ngIf="post.typeFile == 'video'" width="auto" controls="controls" preload="metadata"
            webkit-playsinline="webkit-playsinline" class="videoPlayer">
            <source src="{{post.image}}" type="video/mp4" />
        </video>
        <div class="interactive">
            <ion-icon (click)="toggleHeart()" [name]="heartType" [color]="heartColor"></ion-icon>
            <ion-icon (click)="toggle()" src="/assets/icons/chatbubble-outline.svg"></ion-icon>
            <ion-icon (click)="sendShare(messageBody.innerText, 
            messageSubject.innerText, 'http://ucarecdn.com/11a5036f-c572-4171-acfe-374b9de95222/-/preview/')"
                src="/assets/icons/paper-plane-outline.svg">
            </ion-icon>
            <p class="insta-text"><b>{{ countLiked() }}</b></p>
        </div>
        <p class="insta-text"><b (click)="goToUser(post.userID)" style="color: black;">{{post.author}}</b> <dfn
                style="font-size: 14px; color: black;"> {{post.title}}</dfn></p>
        <p class="insta-text">{{post.content}}</p>


        <div class="post-content" *ngFor="let comment of commentsRef | async">
            <ion-item-sliding>
                <ion-item>
                    <ion-avatar slot="start" style="max-width: 25px; max-height: 25px;">
                        <img src="http://ucarecdn.com/{{comment.profilePic}}/-/preview/">
                    </ion-avatar>
                    <ion-label>
                        <p style="font-size: small; color: black;"><strong (click)="goToUser(comment.userID)"><b
                                    style=" color: black;">{{comment.displayName}}</b></strong> {{comment.comment}}</p>
                    </ion-label>
                    <ion-item-options side="end">
                        <ion-item-option color="danger">Delete</ion-item-option>
                    </ion-item-options>
                </ion-item>
            </ion-item-sliding>
        </div>

    </ion-card>
    <ion-footer *ngIf="show">
        <ion-grid>
            <ion-row class="comment-area">
                <ion-col size="9">
                    <ion-textarea placeholder="Enter your comment..." (keyup.enter)="comment()"
                        [(ngModel)]="inputComment" ngModel required></ion-textarea>
                </ion-col>
                <ion-col size="3">
                    <button ion-button class="comment-button" (click)="comment()" autofocus>
                        <ion-icon name="paper-plane"></ion-icon>
                    </button>
                </ion-col>
            </ion-row>
        </ion-grid>

    </ion-footer>
</ion-content>